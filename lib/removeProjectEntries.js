"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    default: function() {
        return removeProjectEntries;
    },
    removeEntryOperation: function() {
        return removeEntryOperation;
    }
});
var _fsExtra = require("fs-extra");
var _necessary = require("necessary");
var _pathMaps = require("./utilities/pathMaps");
var concatenatePaths = _necessary.pathUtilities.concatenatePaths, checkEntryExists = _necessary.fileSystemUtilities.checkEntryExists, isEntryDirectory = _necessary.fileSystemUtilities.isEntryDirectory, isDirectoryEmpty = _necessary.fileSystemUtilities.isDirectoryEmpty;
function removeProjectEntries(projectsDirectoryPath, json, callback) {
    var pathMaps = json.pathMaps, sourceEntryPaths = [], targetEntryPaths = [], done = function() {
        var _$json = {
            sourceEntryPaths: sourceEntryPaths,
            targetEntryPaths: targetEntryPaths
        };
        callback(_$json);
    };
    (0, _pathMaps.asynchronousForEach)(pathMaps, function(sourceEntryPath, targetEntryPath, entryDirectory, next, done, index) {
        removeEntryOperation(sourceEntryPath, targetEntryPath, projectsDirectoryPath, function(sourceEntryPath, targetEntryPath) {
            sourceEntryPaths.push(sourceEntryPath);
            targetEntryPaths.push(targetEntryPath);
            next();
        });
    }, done);
}
function removeEntryOperation(sourceEntryPath, targetEntryPath, projectsDirectoryPath, callback) {
    if (sourceEntryPath === targetEntryPath) {
        callback(sourceEntryPath, targetEntryPath);
        return;
    }
    var absoluteSourceEntryPath = concatenatePaths(projectsDirectoryPath, sourceEntryPath), entryExists = checkEntryExists(absoluteSourceEntryPath);
    if (!entryExists) {
        targetEntryPath = null;
        callback(sourceEntryPath, targetEntryPath);
        return;
    }
    var entryDirectory = isEntryDirectory(absoluteSourceEntryPath);
    entryDirectory ? removeDirectory(sourceEntryPath, projectsDirectoryPath, callback) : removeFile(sourceEntryPath, projectsDirectoryPath, callback);
}
function removeFile(sourceEntryPath, projectsDirectoryPath, callback) {
    var absoluteSourceEntryPath = concatenatePaths(projectsDirectoryPath, sourceEntryPath);
    (0, _fsExtra.remove)(absoluteSourceEntryPath, function(error) {
        var targetEntryPath = null;
        if (error) {
            sourceEntryPath = null;
            callback(sourceEntryPath, targetEntryPath);
            return;
        }
        callback(sourceEntryPath, targetEntryPath);
    });
}
function removeDirectory(sourceEntryPath, projectsDirectoryPath, callback) {
    var absoluteSourceEntryPath = concatenatePaths(projectsDirectoryPath, sourceEntryPath), sourceDirectoryEmpty = isDirectoryEmpty(absoluteSourceEntryPath);
    if (!sourceDirectoryEmpty) {
        var targetEntryPath = null;
        sourceEntryPath = null;
        callback(sourceEntryPath, targetEntryPath);
        return;
    }
    (0, _fsExtra.remove)(absoluteSourceEntryPath, function(error) {
        var targetEntryPath = null;
        if (error) {
            sourceEntryPath = null;
        }
        callback(sourceEntryPath, targetEntryPath);
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZW1vdmVQcm9qZWN0RW50cmllcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IHsgcmVtb3ZlIH0gZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgeyBwYXRoVXRpbGl0aWVzLCBmaWxlU3lzdGVtVXRpbGl0aWVzIH0gZnJvbSBcIm5lY2Vzc2FyeVwiO1xuXG5pbXBvcnQgeyBhc3luY2hyb25vdXNGb3JFYWNoIH0gZnJvbSBcIi4vdXRpbGl0aWVzL3BhdGhNYXBzXCI7XG5cbmNvbnN0IHsgY29uY2F0ZW5hdGVQYXRocyB9ID0gcGF0aFV0aWxpdGllcyxcbiAgICAgIHsgY2hlY2tFbnRyeUV4aXN0cywgaXNFbnRyeURpcmVjdG9yeSwgaXNEaXJlY3RvcnlFbXB0eSB9ID0gZmlsZVN5c3RlbVV0aWxpdGllcztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcmVtb3ZlUHJvamVjdEVudHJpZXMocHJvamVjdHNEaXJlY3RvcnlQYXRoLCBqc29uLCBjYWxsYmFjaykge1xuICBjb25zdCB7IHBhdGhNYXBzIH0gPSBqc29uLFxuICAgICAgICBzb3VyY2VFbnRyeVBhdGhzID0gW10sXG5cdFx0ICAgIHRhcmdldEVudHJ5UGF0aHMgPSBbXSxcbiAgICAgICAgZG9uZSA9ICgpID0+IHtcbiAgICAgICAgICBjb25zdCBqc29uID0ge1xuICAgICAgICAgICAgc291cmNlRW50cnlQYXRocyxcbiAgICAgICAgICAgIHRhcmdldEVudHJ5UGF0aHNcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgY2FsbGJhY2soanNvbik7XG4gICAgICAgIH07XG5cbiAgYXN5bmNocm9ub3VzRm9yRWFjaChcbiAgICBwYXRoTWFwcyxcbiAgICAoc291cmNlRW50cnlQYXRoLCB0YXJnZXRFbnRyeVBhdGgsIGVudHJ5RGlyZWN0b3J5LCBuZXh0LCBkb25lLCBpbmRleCkgPT4ge1xuICAgICAgcmVtb3ZlRW50cnlPcGVyYXRpb24oc291cmNlRW50cnlQYXRoLCB0YXJnZXRFbnRyeVBhdGgsIHByb2plY3RzRGlyZWN0b3J5UGF0aCwgKHNvdXJjZUVudHJ5UGF0aCwgdGFyZ2V0RW50cnlQYXRoKSA9PiB7XG4gICAgICAgIHNvdXJjZUVudHJ5UGF0aHMucHVzaChzb3VyY2VFbnRyeVBhdGgpO1xuICAgICAgICB0YXJnZXRFbnRyeVBhdGhzLnB1c2godGFyZ2V0RW50cnlQYXRoKTtcblxuICAgICAgICBuZXh0KCk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRvbmVcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUVudHJ5T3BlcmF0aW9uKHNvdXJjZUVudHJ5UGF0aCwgdGFyZ2V0RW50cnlQYXRoLCBwcm9qZWN0c0RpcmVjdG9yeVBhdGgsIGNhbGxiYWNrKSB7XG4gIGlmIChzb3VyY2VFbnRyeVBhdGggPT09IHRhcmdldEVudHJ5UGF0aCkge1xuICAgIGNhbGxiYWNrKHNvdXJjZUVudHJ5UGF0aCwgdGFyZ2V0RW50cnlQYXRoKTtcblxuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGFic29sdXRlU291cmNlRW50cnlQYXRoID0gY29uY2F0ZW5hdGVQYXRocyhwcm9qZWN0c0RpcmVjdG9yeVBhdGgsIHNvdXJjZUVudHJ5UGF0aCksXG4gICAgICAgIGVudHJ5RXhpc3RzID0gY2hlY2tFbnRyeUV4aXN0cyhhYnNvbHV0ZVNvdXJjZUVudHJ5UGF0aCk7XG5cbiAgaWYgKCFlbnRyeUV4aXN0cykge1xuICAgIHRhcmdldEVudHJ5UGF0aCA9IG51bGw7XG5cbiAgICBjYWxsYmFjayhzb3VyY2VFbnRyeVBhdGgsIHRhcmdldEVudHJ5UGF0aCk7XG5cbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBlbnRyeURpcmVjdG9yeSA9IGlzRW50cnlEaXJlY3RvcnkoYWJzb2x1dGVTb3VyY2VFbnRyeVBhdGgpO1xuXG4gIGVudHJ5RGlyZWN0b3J5ID9cbiAgICByZW1vdmVEaXJlY3Rvcnkoc291cmNlRW50cnlQYXRoLCBwcm9qZWN0c0RpcmVjdG9yeVBhdGgsIGNhbGxiYWNrKSA6XG4gICAgICByZW1vdmVGaWxlKHNvdXJjZUVudHJ5UGF0aCwgcHJvamVjdHNEaXJlY3RvcnlQYXRoLCBjYWxsYmFjayk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUZpbGUoc291cmNlRW50cnlQYXRoLCBwcm9qZWN0c0RpcmVjdG9yeVBhdGgsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IGFic29sdXRlU291cmNlRW50cnlQYXRoID0gY29uY2F0ZW5hdGVQYXRocyhwcm9qZWN0c0RpcmVjdG9yeVBhdGgsIHNvdXJjZUVudHJ5UGF0aCk7XG5cbiAgcmVtb3ZlKGFic29sdXRlU291cmNlRW50cnlQYXRoLCAoZXJyb3IpID0+IHtcbiAgICBjb25zdCB0YXJnZXRFbnRyeVBhdGggPSBudWxsO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBzb3VyY2VFbnRyeVBhdGggPSBudWxsO1xuXG4gICAgICBjYWxsYmFjayhzb3VyY2VFbnRyeVBhdGgsIHRhcmdldEVudHJ5UGF0aCk7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYWxsYmFjayhzb3VyY2VFbnRyeVBhdGgsIHRhcmdldEVudHJ5UGF0aCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiByZW1vdmVEaXJlY3Rvcnkoc291cmNlRW50cnlQYXRoLCBwcm9qZWN0c0RpcmVjdG9yeVBhdGgsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IGFic29sdXRlU291cmNlRW50cnlQYXRoID0gY29uY2F0ZW5hdGVQYXRocyhwcm9qZWN0c0RpcmVjdG9yeVBhdGgsIHNvdXJjZUVudHJ5UGF0aCksXG4gICAgICAgIHNvdXJjZURpcmVjdG9yeUVtcHR5ID0gaXNEaXJlY3RvcnlFbXB0eShhYnNvbHV0ZVNvdXJjZUVudHJ5UGF0aCk7XG5cbiAgaWYgKCFzb3VyY2VEaXJlY3RvcnlFbXB0eSkge1xuICAgIGNvbnN0IHRhcmdldEVudHJ5UGF0aCA9IG51bGw7XG5cbiAgICBzb3VyY2VFbnRyeVBhdGggPSBudWxsO1xuXG4gICAgY2FsbGJhY2soc291cmNlRW50cnlQYXRoLCB0YXJnZXRFbnRyeVBhdGgpO1xuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcmVtb3ZlKGFic29sdXRlU291cmNlRW50cnlQYXRoLCAoZXJyb3IpID0+IHtcbiAgICBjb25zdCB0YXJnZXRFbnRyeVBhdGggPSBudWxsO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBzb3VyY2VFbnRyeVBhdGggPSBudWxsO1xuICAgIH1cblxuICAgIGNhbGxiYWNrKHNvdXJjZUVudHJ5UGF0aCwgdGFyZ2V0RW50cnlQYXRoKTtcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsicmVtb3ZlUHJvamVjdEVudHJpZXMiLCJyZW1vdmVFbnRyeU9wZXJhdGlvbiIsImNvbmNhdGVuYXRlUGF0aHMiLCJwYXRoVXRpbGl0aWVzIiwiY2hlY2tFbnRyeUV4aXN0cyIsImZpbGVTeXN0ZW1VdGlsaXRpZXMiLCJpc0VudHJ5RGlyZWN0b3J5IiwiaXNEaXJlY3RvcnlFbXB0eSIsInByb2plY3RzRGlyZWN0b3J5UGF0aCIsImpzb24iLCJjYWxsYmFjayIsInBhdGhNYXBzIiwic291cmNlRW50cnlQYXRocyIsInRhcmdldEVudHJ5UGF0aHMiLCJkb25lIiwiYXN5bmNocm9ub3VzRm9yRWFjaCIsInNvdXJjZUVudHJ5UGF0aCIsInRhcmdldEVudHJ5UGF0aCIsImVudHJ5RGlyZWN0b3J5IiwibmV4dCIsImluZGV4IiwicHVzaCIsImFic29sdXRlU291cmNlRW50cnlQYXRoIiwiZW50cnlFeGlzdHMiLCJyZW1vdmVEaXJlY3RvcnkiLCJyZW1vdmVGaWxlIiwicmVtb3ZlIiwiZXJyb3IiLCJzb3VyY2VEaXJlY3RvcnlFbXB0eSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7O0lBVUEsT0F5QkM7ZUF6QnVCQTs7SUEyQlJDLG9CQUFvQjtlQUFwQkE7Ozt1QkFuQ087eUJBQzRCO3dCQUVmO0FBRXBDLElBQU0sQUFBRUMsbUJBQXFCQyx3QkFBYSxDQUFsQ0Qsa0JBQ0FFLG1CQUF5REMsOEJBQW1CLENBQTVFRCxrQkFBa0JFLG1CQUF1Q0QsOEJBQW1CLENBQTFEQyxrQkFBa0JDLG1CQUFxQkYsOEJBQW1CLENBQXhDRTtBQUU3QixTQUFTUCxxQkFBcUJRLHFCQUFxQixFQUFFQyxJQUFJLEVBQUVDLFFBQVEsRUFBRTtJQUNsRixJQUFNLEFBQUVDLFdBQWFGLEtBQWJFLFVBQ0ZDLG1CQUFtQixFQUFFLEVBQ3ZCQyxtQkFBbUIsRUFBRSxFQUNuQkMsT0FBTyxXQUFNO1FBQ1gsSUFBTUwsU0FBTztZQUNYRyxrQkFBQUE7WUFDQUMsa0JBQUFBO1FBQ0Y7UUFFQUgsU0FBU0Q7SUFDWDtJQUVOTSxJQUFBQSw2QkFBbUIsRUFDakJKLFVBQ0EsU0FBQ0ssaUJBQWlCQyxpQkFBaUJDLGdCQUFnQkMsTUFBTUwsTUFBTU0sT0FBVTtRQUN2RW5CLHFCQUFxQmUsaUJBQWlCQyxpQkFBaUJULHVCQUF1QixTQUFDUSxpQkFBaUJDLGlCQUFvQjtZQUNsSEwsaUJBQWlCUyxJQUFJLENBQUNMO1lBQ3RCSCxpQkFBaUJRLElBQUksQ0FBQ0o7WUFFdEJFO1FBQ0Y7SUFDRixHQUNBTDtBQUVKO0FBRU8sU0FBU2IscUJBQXFCZSxlQUFlLEVBQUVDLGVBQWUsRUFBRVQscUJBQXFCLEVBQUVFLFFBQVEsRUFBRTtJQUN0RyxJQUFJTSxvQkFBb0JDLGlCQUFpQjtRQUN2Q1AsU0FBU00saUJBQWlCQztRQUUxQjtJQUNGLENBQUM7SUFFRCxJQUFNSywwQkFBMEJwQixpQkFBaUJNLHVCQUF1QlEsa0JBQ2xFTyxjQUFjbkIsaUJBQWlCa0I7SUFFckMsSUFBSSxDQUFDQyxhQUFhO1FBQ2hCTixrQkFBa0IsSUFBSTtRQUV0QlAsU0FBU00saUJBQWlCQztRQUUxQjtJQUNGLENBQUM7SUFFRCxJQUFNQyxpQkFBaUJaLGlCQUFpQmdCO0lBRXhDSixpQkFDRU0sZ0JBQWdCUixpQkFBaUJSLHVCQUF1QkUsWUFDdERlLFdBQVdULGlCQUFpQlIsdUJBQXVCRSxTQUFTO0FBQ2xFO0FBRUEsU0FBU2UsV0FBV1QsZUFBZSxFQUFFUixxQkFBcUIsRUFBRUUsUUFBUSxFQUFFO0lBQ3BFLElBQU1ZLDBCQUEwQnBCLGlCQUFpQk0sdUJBQXVCUTtJQUV4RVUsSUFBQUEsZUFBTSxFQUFDSix5QkFBeUIsU0FBQ0ssT0FBVTtRQUN6QyxJQUFNVixrQkFBa0IsSUFBSTtRQUU1QixJQUFJVSxPQUFPO1lBQ1RYLGtCQUFrQixJQUFJO1lBRXRCTixTQUFTTSxpQkFBaUJDO1lBRTFCO1FBQ0YsQ0FBQztRQUVEUCxTQUFTTSxpQkFBaUJDO0lBQzVCO0FBQ0Y7QUFFQSxTQUFTTyxnQkFBZ0JSLGVBQWUsRUFBRVIscUJBQXFCLEVBQUVFLFFBQVEsRUFBRTtJQUN6RSxJQUFNWSwwQkFBMEJwQixpQkFBaUJNLHVCQUF1QlEsa0JBQ2xFWSx1QkFBdUJyQixpQkFBaUJlO0lBRTlDLElBQUksQ0FBQ00sc0JBQXNCO1FBQ3pCLElBQU1YLGtCQUFrQixJQUFJO1FBRTVCRCxrQkFBa0IsSUFBSTtRQUV0Qk4sU0FBU00saUJBQWlCQztRQUUxQjtJQUNGLENBQUM7SUFFRFMsSUFBQUEsZUFBTSxFQUFDSix5QkFBeUIsU0FBQ0ssT0FBVTtRQUN6QyxJQUFNVixrQkFBa0IsSUFBSTtRQUU1QixJQUFJVSxPQUFPO1lBQ1RYLGtCQUFrQixJQUFJO1FBQ3hCLENBQUM7UUFFRE4sU0FBU00saUJBQWlCQztJQUM1QjtBQUNGIn0=